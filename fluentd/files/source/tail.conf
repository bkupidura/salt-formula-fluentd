<source>
  @type tail
  path {{ values.path }}
  tag {{ values.tag }}
{%- if values.get('exclude_path') %}{# Replace 'for-if-else' with 'tojson' after updating to jinja 2.9 #}
  exclude_path [{%- for path in values.exclude_path %}"{{ path }}"{{ ", " if not loop.last else '' }} {%- endfor %}]
{%- endif %}
{%- if values.get('path_key') %}
  path_key {{ values.path_key }}
{%- endif %}
  <parse>
{%- with values=values.get('parser') %}
    @type {{ values.get('type') }}
{% include 'fluentd/files/parser/' + values.get('type') + '.conf' %}
{%- endwith %}
  </parse>
</source>
